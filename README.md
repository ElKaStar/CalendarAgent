# ü§ñ Calendar Agent - Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Google Calendar

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Google –ö–∞–ª–µ–Ω–¥–∞—Ä—ë–º —á–µ—Ä–µ–∑ –≥–æ–ª–æ—Å–æ–≤—ã–µ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GigaChat –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ Google Calendar —á–µ—Ä–µ–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —è–∑—ã–∫
- üé§ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (STT)
- üîî –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–æ–±—ã—Ç–∏—è–º–∏
- üìã –ü—Ä–æ—Å–º–æ—Ç—Ä –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ–±—ã—Ç–∏–π
- ‚ùå –û—Ç–º–µ–Ω–∞ —Å–æ–±—ã—Ç–∏–π
- ü§ñ –£–º–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ GigaChat

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- Telegram Bot Token (–æ—Ç @BotFather)
- GigaChat API credentials
- Google Calendar API (Service Account)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```bash
cp .env.example .env
nano .env
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Calendar

#### –°–æ–∑–¥–∞–Ω–∏–µ Service Account:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.cloud.google.com/
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Calendar Bot")
3. –í–∫–ª—é—á–∏—Ç–µ Google Calendar API
4. –°–æ–∑–¥–∞–π—Ç–µ Service Account:
   - APIs & Services ‚Üí Credentials
   - Create Credentials ‚Üí Service Account
   - –£–∫–∞–∂–∏—Ç–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "calendar-bot")
5. –°–∫–∞—á–∞–π—Ç–µ JSON-–∫–ª—é—á:
   - –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Service Account
   - Keys ‚Üí Add Key ‚Üí Create new key ‚Üí JSON
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `service-account.json`
6. –î–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é:
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π JSON –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ `client_email`
   - –û—Ç–∫—Ä–æ–π—Ç–µ Google Calendar
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞
   - –î–æ–±–∞–≤—å—Ç–µ email Service Account —Å –ø—Ä–∞–≤–∞–º–∏ "–í–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è"

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ GigaChat credentials

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://developers.sber.ru/portal/products/gigachat
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ü–æ–ª—É—á–∏—Ç–µ `CLIENT_ID` –∏ `CLIENT_SECRET`
4. –£–∫–∞–∂–∏—Ç–µ –∏—Ö –≤ `.env`

### 5. –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞

1. –ù–∞–π–¥–∏—Ç–µ @BotFather –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env`

### 6. –ó–∞–ø—É—Å–∫

```bash
python bot.py
```

–ò–ª–∏ –≤ —Ñ–æ–Ω–µ (Linux):

```bash
nohup python bot.py > bot.log 2>&1 &
```

## üí¨ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:

- `/start` - –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- `/help` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- `/list` - –ø–æ–∫–∞–∑–∞—Ç—å –±–ª–∏–∂–∞–π—à–∏–µ 5 —Å–æ–±—ã—Ç–∏–π
- `/cancel <–Ω–∞–∑–≤–∞–Ω–∏–µ>` - –æ—Ç–º–µ–Ω–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:

```
–ó–∞–≤—Ç—Ä–∞ –≤ 15:00 –≤—Å—Ç—Ä–µ—á–∞ —Å –ö–∞—Ç–µ–π –ø–æ –∏–ø–æ—Ç–µ–∫–µ, —á–∞—Å
–ü–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞ –≤ 10:00 —Å–æ–∑–≤–æ–Ω —Å –∫–æ–º–∞–Ω–¥–æ–π, 30 –º–∏–Ω—É—Ç, –æ–Ω–ª–∞–π–Ω
–í –ø—è—Ç–Ω–∏—Ü—É –≤ 18:00 —É–∂–∏–Ω —Å –¥—Ä—É–∑—å—è–º–∏
–ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é –ø–ª–∞–Ω—ë—Ä–∫–∞ —Å 9:00 –¥–æ 10:30
```

### –û—Ç–≤–µ—Ç –±–æ—Ç–∞:

```
‚úÖ –°–æ–∑–¥–∞–ª–∞ —Å–æ–±—ã—Ç–∏–µ:

üìå –í—Å—Ç—Ä–µ—á–∞ —Å –ö–∞—Ç–µ–π –ø–æ –∏–ø–æ—Ç–µ–∫–µ
üïê 16.01.2024 15:00 - 16:00

‚è∞ –ù–∞–ø–æ–º–Ω—é –∑–∞ 15 –º–∏–Ω—É—Ç
```

### –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ:

```
‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ!

üìå –í—Å—Ç—Ä–µ—á–∞ —Å –ö–∞—Ç–µ–π –ø–æ –∏–ø–æ—Ç–µ–∫–µ
üïê 16.01.2024 –≤ 15:00

–ß–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | - |
| `GIGACHAT_CLIENT_ID` | GigaChat Client ID | - |
| `GIGACHAT_CLIENT_SECRET` | GigaChat Client Secret | - |
| `GIGACHAT_SCOPE` | GigaChat Scope | `GIGACHAT_API_PERS` |
| `GOOGLE_CREDENTIALS_FILE` | –ü—É—Ç—å –∫ Service Account JSON | `service-account.json` |
| `GOOGLE_CALENDAR_ID` | ID –∫–∞–ª–µ–Ω–¥–∞—Ä—è | `primary` |
| `TIMEZONE` | –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞ | `Europe/Moscow` |
| `REMINDER_MINUTES_BEFORE` | –ú–∏–Ω—É—Ç –¥–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è | `15` |
| `REMINDER_CHECK_INTERVAL` | –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Å–µ–∫) | `60` |
| `DATABASE_FILE` | –§–∞–π–ª –ë–î SQLite | `events.db` |
| `TEMP_DIR` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è temp —Ñ–∞–π–ª–æ–≤ | `temp` |

## üêõ Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f bot.log`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω: `ps aux | grep bot.py`

### –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ GigaChat

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `GIGACHAT_CLIENT_ID` –∏ `GIGACHAT_CLIENT_SECRET`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ scope –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: `GIGACHAT_API_PERS`

### –ù–µ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è –≤ Google Calendar

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Service Account email –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ `service-account.json`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Google Calendar API –≤–∫–ª—é—á—ë–Ω

### –ù–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `reminder_worker` –∑–∞–ø—É—â–µ–Ω (—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `REMINDER_CHECK_INTERVAL`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ë–î: `sqlite3 events.db "SELECT * FROM events;"`

### –û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `STT_API_KEY` –∏ `STT_FOLDER_ID`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç –∞—É–¥–∏–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
CalendarAgent/
‚îú‚îÄ‚îÄ bot.py                  # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ .env.example           # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .env                   # –í–∞—à–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ service-account.json   # Google Service Account (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ events.db             # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ bot.log               # –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ temp/                 # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–≥–æ–ª–æ—Å–æ–≤—ã–µ)
‚îú‚îÄ‚îÄ PRD.md               # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md            # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üìù –õ–æ–≥–∏

–õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤:
- `bot.log` - —Ñ–∞–π–ª —Å –∏—Å—Ç–æ—Ä–∏–µ–π
- `stdout` - –∫–æ–Ω—Å–æ–ª—å

–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- `INFO` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –∫–æ–º–∞–Ω–¥—ã
- `WARNING` - –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏, –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏
- `ERROR` - –æ—à–∏–±–∫–∏ API, –ø–∞—Ä—Å–∏–Ω–≥–∞, —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚ö†Ô∏è –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –∏ `service-account.json` –≤ git
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.gitignore` –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚ö†Ô∏è –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -U -r requirements.txt`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ [PRD.md](PRD.md)

---

–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º

