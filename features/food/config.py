"""
Конфигурация модуля дневника питания
"""
from typing import List, Dict

# Кодовые слова для дневника питания
# Сообщения, начинающиеся с этих слов, всегда обрабатываются как записи о еде
FOOD_CODE_WORDS: List[str] = [
    'menu',
    'меню',
]

# Исправления ошибок распознавания речи для кодовых слов
# Ключ - неправильно распознанное слово, значение - правильное
SPEECH_CORRECTIONS_CODE_WORDS: Dict[str, str] = {
    'миню': 'меню',
    'мину': 'меню',
    'мену': 'меню',
}

# Исправления ошибок распознавания речи для продуктов и других слов
# Регулярные выражения для поиска и замены
SPEECH_CORRECTIONS_PATTERNS: Dict[str, str] = {
    r'\bотстану\s+кашу\b': 'овсяную кашу',
    r'\bотстану\s+каши\b': 'овсяной каши',
    r'\bотстану\s+каша\b': 'овсяная каша',
    r'\bовсянку\b': 'овсяную кашу',
    r'\bовсянка\b': 'овсяная каша',
    # Исправления ошибок распознавания кодовых слов в начале текста
    r'^миню\s+': 'меню ',
    r'^мину\s+': 'меню ',
    r'^мену\s+': 'меню ',
    # Исправления для картофельного пюре (базовые, если Whisper всё ещё ошибается)
    r'\bкартофель\s+на\b': 'картофельное пюре',
    r'\bкартофель\s+пюре\b': 'картофельное пюре',
    # Исправления для пшеничной каши (часто распознаётся как овсяная)
    # ВАЖНО: применяем только если в тексте есть намёк на "пшенич" или если пользователь явно сказал "пшеничная"
    # Но так как Whisper может распознать "пшеничная" как "овсяная", добавляем обратное исправление
    # Это рискованно, но если пользователь говорит "пшеничная каша", а Whisper распознал как "овсяная каша",
    # то нужно исправить. Однако мы не можем заменить все "овсяная" на "пшеничная".
    # Поэтому добавляем исправление только если есть контекст "пшенич" или если это явно указано
    r'\bпшенич\s+каша\b': 'пшеничная каша',
    r'\bпшенич\s+каши\b': 'пшеничной каши',
    r'\bпшенич\s+кашу\b': 'пшеничную кашу',
    r'\bпшеничн\s+каша\b': 'пшеничная каша',
    r'\bпшеничн\s+каши\b': 'пшеничной каши',
    r'\bпшеничн\s+кашу\b': 'пшеничную кашу',
    # Если Whisper распознал "пшеничная" как "овсяная", но в тексте есть части слова "пшенич"
    # Это сложно, поэтому лучше полагаться на промпт Whisper
    # Исправления для граммов с ошибками распознавания (в любом месте текста)
    r'\bрамм\b': 'грамм',
    r'\bрамма\b': 'грамма',
    r'\bраммов\b': 'граммов',
    r'\bрамм\.': 'грамм',
    r'грамма(\d+)': r'грамм',
    r'грамм(\d+)': r'грамм',
    r'рамма(\d+)': r'грамм',
    r'рамм(\d+)': r'грамм',
}

